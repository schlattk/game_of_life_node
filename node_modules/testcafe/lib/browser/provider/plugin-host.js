'use strict';

exports.__esModule = true;

var _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');

var _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);

var _symbol = require('babel-runtime/core-js/symbol');

var _symbol2 = _interopRequireDefault(_symbol);

var _pinkie = require('pinkie');

var _pinkie2 = _interopRequireDefault(_pinkie);

var _lodash = require('lodash');

var _promisifyEvent = require('promisify-event');

var _promisifyEvent2 = _interopRequireDefault(_promisifyEvent);

var _browserJobResult = require('../../runner/browser-job-result');

var _browserJobResult2 = _interopRequireDefault(_browserJobResult);

var _connection = require('../connection');

var _connection2 = _interopRequireDefault(_connection);

var _warningMessage = require('../../notifications/warning-message');

var _warningMessage2 = _interopRequireDefault(_warningMessage);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/* global Symbol */
const name = (0, _symbol2.default)();

class BrowserProviderPluginHost {
    constructor(providerObject, providerName) {
        this.JOB_RESULT = (0, _lodash.assignIn)({}, _browserJobResult2.default);

        (0, _lodash.assignIn)(this, providerObject);

        this[name] = providerName;
    }

    // Helpers
    get providerName() {
        return this[name];
    }

    runInitScript(browserId, code) {
        const connection = _connection2.default.getById(browserId);

        return connection.runInitScript(`(${code})()`);
    }

    waitForConnectionReady(browserId) {
        const connection = _connection2.default.getById(browserId);

        if (connection.ready) return _pinkie2.default.resolve();

        return (0, _promisifyEvent2.default)(connection, 'ready');
    }

    reportWarning(browserId, ...args) {
        const connection = _connection2.default.getById(browserId);

        connection.addWarning(...args);
    }

    setUserAgentMetaInfo(browserId, message) {
        const connection = _connection2.default.getById(browserId);

        connection.setProviderMetaInfo(message);
    }

    closeLocalBrowser(browserId) {
        return (0, _asyncToGenerator3.default)(function* () {
            const connection = _connection2.default.getById(browserId);

            yield connection.provider._ensureBrowserWindowDescriptor(browserId);
            yield connection.provider._closeLocalBrowser(browserId);
        })();
    }

    resizeLocalBrowserWindow(browserId, width, height, currentWidth, currentHeight) {
        return (0, _asyncToGenerator3.default)(function* () {
            const connection = _connection2.default.getById(browserId);

            yield connection.provider._ensureBrowserWindowParameters(browserId);
            yield connection.provider._resizeLocalBrowserWindow(browserId, width, height, currentWidth, currentHeight);
        })();
    }

    // API
    // Browser control
    openBrowser() /* browserId, pageUrl, browserName */{
        return (0, _asyncToGenerator3.default)(function* () {
            throw new Error('Not implemented!');
        })();
    }

    closeBrowser() /* browserId */{
        return (0, _asyncToGenerator3.default)(function* () {
            throw new Error('Not implemented!');
        })();
    }

    // Initialization
    init() {
        return (0, _asyncToGenerator3.default)(function* () {
            return;
        })();
    }

    dispose() {
        return (0, _asyncToGenerator3.default)(function* () {
            return;
        })();
    }

    // Browser names handling
    getBrowserList() {
        return (0, _asyncToGenerator3.default)(function* () {
            throw new Error('Not implemented!');
        })();
    }

    isValidBrowserName() /* browserName */{
        return (0, _asyncToGenerator3.default)(function* () {
            return true;
        })();
    }

    // Extra functions
    isLocalBrowser() /* browserId, browserName */{
        return (0, _asyncToGenerator3.default)(function* () {
            return false;
        })();
    }

    isHeadlessBrowser() {
        return false;
    }

    hasCustomActionForBrowser() /* browserId */{
        var _this = this;

        return (0, _asyncToGenerator3.default)(function* () {
            return {
                hasCloseBrowser: _this.hasOwnProperty('closeBrowser'),
                hasResizeWindow: _this.hasOwnProperty('resizeWindow'),
                hasTakeScreenshot: _this.hasOwnProperty('takeScreenshot'),
                hasCanResizeWindowToDimensions: _this.hasOwnProperty('canResizeWindowToDimensions'),
                hasMaximizeWindow: _this.hasOwnProperty('maximizeWindow'),
                hasChromelessScreenshots: false
            };
        })();
    }

    resizeWindow(browserId /*, width, height, currentWidth, currentHeight */) {
        var _this2 = this;

        return (0, _asyncToGenerator3.default)(function* () {
            _this2.reportWarning(browserId, _warningMessage2.default.resizeNotSupportedByBrowserProvider, _this2[name]);
        })();
    }

    canResizeWindowToDimensions() /* browserId, width, height */{
        return (0, _asyncToGenerator3.default)(function* () {
            return true;
        })();
    }

    takeScreenshot(browserId /*, screenshotPath, pageWidth, pageHeight */) {
        var _this3 = this;

        return (0, _asyncToGenerator3.default)(function* () {
            _this3.reportWarning(browserId, _warningMessage2.default.screenshotNotSupportedByBrowserProvider, _this3[name]);
        })();
    }

    maximizeWindow(browserId) {
        var _this4 = this;

        return (0, _asyncToGenerator3.default)(function* () {
            _this4.reportWarning(browserId, _warningMessage2.default.maximizeNotSupportedByBrowserProvider, _this4[name]);
        })();
    }

    reportJobResult() /*browserId, status, data*/{
        return (0, _asyncToGenerator3.default)(function* () {
            return;
        })();
    }
}
exports.default = BrowserProviderPluginHost;
module.exports = exports['default'];
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9icm93c2VyL3Byb3ZpZGVyL3BsdWdpbi1ob3N0LmpzIl0sIm5hbWVzIjpbIm5hbWUiLCJCcm93c2VyUHJvdmlkZXJQbHVnaW5Ib3N0IiwiY29uc3RydWN0b3IiLCJwcm92aWRlck9iamVjdCIsInByb3ZpZGVyTmFtZSIsIkpPQl9SRVNVTFQiLCJCUk9XU0VSX0pPQl9SRVNVTFQiLCJydW5Jbml0U2NyaXB0IiwiYnJvd3NlcklkIiwiY29kZSIsImNvbm5lY3Rpb24iLCJCcm93c2VyQ29ubmVjdGlvbiIsImdldEJ5SWQiLCJ3YWl0Rm9yQ29ubmVjdGlvblJlYWR5IiwicmVhZHkiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlcG9ydFdhcm5pbmciLCJhcmdzIiwiYWRkV2FybmluZyIsInNldFVzZXJBZ2VudE1ldGFJbmZvIiwibWVzc2FnZSIsInNldFByb3ZpZGVyTWV0YUluZm8iLCJjbG9zZUxvY2FsQnJvd3NlciIsInByb3ZpZGVyIiwiX2Vuc3VyZUJyb3dzZXJXaW5kb3dEZXNjcmlwdG9yIiwiX2Nsb3NlTG9jYWxCcm93c2VyIiwicmVzaXplTG9jYWxCcm93c2VyV2luZG93Iiwid2lkdGgiLCJoZWlnaHQiLCJjdXJyZW50V2lkdGgiLCJjdXJyZW50SGVpZ2h0IiwiX2Vuc3VyZUJyb3dzZXJXaW5kb3dQYXJhbWV0ZXJzIiwiX3Jlc2l6ZUxvY2FsQnJvd3NlcldpbmRvdyIsIm9wZW5Ccm93c2VyIiwiRXJyb3IiLCJjbG9zZUJyb3dzZXIiLCJpbml0IiwiZGlzcG9zZSIsImdldEJyb3dzZXJMaXN0IiwiaXNWYWxpZEJyb3dzZXJOYW1lIiwiaXNMb2NhbEJyb3dzZXIiLCJpc0hlYWRsZXNzQnJvd3NlciIsImhhc0N1c3RvbUFjdGlvbkZvckJyb3dzZXIiLCJoYXNDbG9zZUJyb3dzZXIiLCJoYXNPd25Qcm9wZXJ0eSIsImhhc1Jlc2l6ZVdpbmRvdyIsImhhc1Rha2VTY3JlZW5zaG90IiwiaGFzQ2FuUmVzaXplV2luZG93VG9EaW1lbnNpb25zIiwiaGFzTWF4aW1pemVXaW5kb3ciLCJoYXNDaHJvbWVsZXNzU2NyZWVuc2hvdHMiLCJyZXNpemVXaW5kb3ciLCJXQVJOSU5HX01FU1NBR0UiLCJyZXNpemVOb3RTdXBwb3J0ZWRCeUJyb3dzZXJQcm92aWRlciIsImNhblJlc2l6ZVdpbmRvd1RvRGltZW5zaW9ucyIsInRha2VTY3JlZW5zaG90Iiwic2NyZWVuc2hvdE5vdFN1cHBvcnRlZEJ5QnJvd3NlclByb3ZpZGVyIiwibWF4aW1pemVXaW5kb3ciLCJtYXhpbWl6ZU5vdFN1cHBvcnRlZEJ5QnJvd3NlclByb3ZpZGVyIiwicmVwb3J0Sm9iUmVzdWx0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFDQTs7OztBQUNBOztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7Ozs7QUFOQTtBQVNBLE1BQU1BLE9BQU8sdUJBQWI7O0FBRWUsTUFBTUMseUJBQU4sQ0FBZ0M7QUFDM0NDLGdCQUFhQyxjQUFiLEVBQTZCQyxZQUE3QixFQUEyQztBQUN2QyxhQUFLQyxVQUFMLEdBQWtCLHNCQUFTLEVBQVQsRUFBYUMsMEJBQWIsQ0FBbEI7O0FBRUEsOEJBQVMsSUFBVCxFQUFlSCxjQUFmOztBQUVBLGFBQUtILElBQUwsSUFBYUksWUFBYjtBQUNIOztBQUdEO0FBQ0EsUUFBSUEsWUFBSixHQUFvQjtBQUNoQixlQUFPLEtBQUtKLElBQUwsQ0FBUDtBQUNIOztBQUVETyxrQkFBZUMsU0FBZixFQUEwQkMsSUFBMUIsRUFBZ0M7QUFDNUIsY0FBTUMsYUFBYUMscUJBQWtCQyxPQUFsQixDQUEwQkosU0FBMUIsQ0FBbkI7O0FBRUEsZUFBT0UsV0FBV0gsYUFBWCxDQUEwQixJQUFHRSxJQUFLLEtBQWxDLENBQVA7QUFDSDs7QUFFREksMkJBQXdCTCxTQUF4QixFQUFtQztBQUMvQixjQUFNRSxhQUFhQyxxQkFBa0JDLE9BQWxCLENBQTBCSixTQUExQixDQUFuQjs7QUFFQSxZQUFJRSxXQUFXSSxLQUFmLEVBQ0ksT0FBT0MsaUJBQVFDLE9BQVIsRUFBUDs7QUFFSixl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QWdDO0FBQUE7QUFDL0QsbUJBQU8sSUFBUDtBQUQrRDtBQUVsRTs7QUFFS0Msa0JBQU4sQ0FBc0IvQyxTQUF0QixDQUErQiw0Q0FBL0IsRUFBNkU7QUFBQTs7QUFBQTtBQUN6RSxtQkFBS1MsYUFBTCxDQUFtQlQsU0FBbkIsRUFBOEI0Qyx5QkFBZ0JJLHVDQUE5QyxFQUF1RixPQUFLeEQsSUFBTCxDQUF2RjtBQUR5RTtBQUU1RTs7QUFFS3lELGtCQUFOLENBQXNCakQsU0FBdEIsRUFBaUM7QUFBQTs7QUFBQTtBQUM3QixtQkFBS1MsYUFBTCxDQUFtQlQsU0FBbkIsRUFBOEI0Qyx5QkFBZ0JNLHFDQUE5QyxFQUFxRixPQUFLMUQsSUFBTCxDQUFyRjtBQUQ2QjtBQUVoQzs7QUFFSzJELG1CQUFOLEdBQXVCLDJCQUE2QjtBQUFBO0FBQ2hEO0FBRGdEO0FBRW5EO0FBM0gwQztrQkFBMUIxRCx5QiIsImZpbGUiOiJicm93c2VyL3Byb3ZpZGVyL3BsdWdpbi1ob3N0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogZ2xvYmFsIFN5bWJvbCAqL1xuaW1wb3J0IFByb21pc2UgZnJvbSAncGlua2llJztcbmltcG9ydCB7IGFzc2lnbkluIH0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCBwcm9taXNpZnlFdmVudCBmcm9tICdwcm9taXNpZnktZXZlbnQnO1xuaW1wb3J0IEJST1dTRVJfSk9CX1JFU1VMVCBmcm9tICcuLi8uLi9ydW5uZXIvYnJvd3Nlci1qb2ItcmVzdWx0JztcbmltcG9ydCBCcm93c2VyQ29ubmVjdGlvbiBmcm9tICcuLi9jb25uZWN0aW9uJztcbmltcG9ydCBXQVJOSU5HX01FU1NBR0UgZnJvbSAnLi4vLi4vbm90aWZpY2F0aW9ucy93YXJuaW5nLW1lc3NhZ2UnO1xuXG5cbmNvbnN0IG5hbWUgPSBTeW1ib2woKTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQnJvd3NlclByb3ZpZGVyUGx1Z2luSG9zdCB7XG4gICAgY29uc3RydWN0b3IgKHByb3ZpZGVyT2JqZWN0LCBwcm92aWRlck5hbWUpIHtcbiAgICAgICAgdGhpcy5KT0JfUkVTVUxUID0gYXNzaWduSW4oe30sIEJST1dTRVJfSk9CX1JFU1VMVCk7XG5cbiAgICAgICAgYXNzaWduSW4odGhpcywgcHJvdmlkZXJPYmplY3QpO1xuXG4gICAgICAgIHRoaXNbbmFtZV0gPSBwcm92aWRlck5hbWU7XG4gICAgfVxuXG5cbiAgICAvLyBIZWxwZXJzXG4gICAgZ2V0IHByb3ZpZGVyTmFtZSAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzW25hbWVdO1xuICAgIH1cblxuICAgIHJ1bkluaXRTY3JpcHQgKGJyb3dzZXJJZCwgY29kZSkge1xuICAgICAgICBjb25zdCBjb25uZWN0aW9uID0gQnJvd3NlckNvbm5lY3Rpb24uZ2V0QnlJZChicm93c2VySWQpO1xuXG4gICAgICAgIHJldHVybiBjb25uZWN0aW9uLnJ1bkluaXRTY3JpcHQoYCgke2NvZGV9KSgpYCk7XG4gICAgfVxuXG4gICAgd2FpdEZvckNvbm5lY3Rpb25SZWFkeSAoYnJvd3NlcklkKSB7XG4gICAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSBCcm93c2VyQ29ubmVjdGlvbi5nZXRCeUlkKGJyb3dzZXJJZCk7XG5cbiAgICAgICAgaWYgKGNvbm5lY3Rpb24ucmVhZHkpXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG5cbiAgICAgICAgcmV0dXJuIHByb21pc2lmeUV2ZW50KGNvbm5lY3Rpb24sICdyZWFkeScpO1xuICAgIH1cblxuICAgIHJlcG9ydFdhcm5pbmcgKGJyb3dzZXJJZCwgLi4uYXJncykge1xuICAgICAgICBjb25zdCBjb25uZWN0aW9uID0gQnJvd3NlckNvbm5lY3Rpb24uZ2V0QnlJZChicm93c2VySWQpO1xuXG4gICAgICAgIGNvbm5lY3Rpb24uYWRkV2FybmluZyguLi5hcmdzKTtcbiAgICB9XG5cbiAgICBzZXRVc2VyQWdlbnRNZXRhSW5mbyAoYnJvd3NlcklkLCBtZXNzYWdlKSB7XG4gICAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSBCcm93c2VyQ29ubmVjdGlvbi5nZXRCeUlkKGJyb3dzZXJJZCk7XG5cbiAgICAgICAgY29ubmVjdGlvbi5zZXRQcm92aWRlck1ldGFJbmZvKG1lc3NhZ2UpO1xuICAgIH1cblxuICAgIGFzeW5jIGNsb3NlTG9jYWxCcm93c2VyIChicm93c2VySWQpIHtcbiAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IEJyb3dzZXJDb25uZWN0aW9uLmdldEJ5SWQoYnJvd3NlcklkKTtcblxuICAgICAgICBhd2FpdCBjb25uZWN0aW9uLnByb3ZpZGVyLl9lbnN1cmVCcm93c2VyV2luZG93RGVzY3JpcHRvcihicm93c2VySWQpO1xuICAgICAgICBhd2FpdCBjb25uZWN0aW9uLnByb3ZpZGVyLl9jbG9zZUxvY2FsQnJvd3Nlcihicm93c2VySWQpO1xuICAgIH1cblxuICAgIGFzeW5jIHJlc2l6ZUxvY2FsQnJvd3NlcldpbmRvdyAoYnJvd3NlcklkLCB3aWR0aCwgaGVpZ2h0LCBjdXJyZW50V2lkdGgsIGN1cnJlbnRIZWlnaHQpIHtcbiAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IEJyb3dzZXJDb25uZWN0aW9uLmdldEJ5SWQoYnJvd3NlcklkKTtcblxuICAgICAgICBhd2FpdCBjb25uZWN0aW9uLnByb3ZpZGVyLl9lbnN1cmVCcm93c2VyV2luZG93UGFyYW1ldGVycyhicm93c2VySWQpO1xuICAgICAgICBhd2FpdCBjb25uZWN0aW9uLnByb3ZpZGVyLl9yZXNpemVMb2NhbEJyb3dzZXJXaW5kb3coYnJvd3NlcklkLCB3aWR0aCwgaGVpZ2h0LCBjdXJyZW50V2lkdGgsIGN1cnJlbnRIZWlnaHQpO1xuICAgIH1cblxuICAgIC8vIEFQSVxuICAgIC8vIEJyb3dzZXIgY29udHJvbFxuICAgIGFzeW5jIG9wZW5Ccm93c2VyICgvKiBicm93c2VySWQsIHBhZ2VVcmwsIGJyb3dzZXJOYW1lICovKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm90IGltcGxlbWVudGVkIScpO1xuICAgIH1cblxuICAgIGFzeW5jIGNsb3NlQnJvd3NlciAoLyogYnJvd3NlcklkICovKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm90IGltcGxlbWVudGVkIScpO1xuICAgIH1cblxuICAgIC8vIEluaXRpYWxpemF0aW9uXG4gICAgYXN5bmMgaW5pdCAoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBhc3luYyBkaXNwb3NlICgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuXG4gICAgLy8gQnJvd3NlciBuYW1lcyBoYW5kbGluZ1xuICAgIGFzeW5jIGdldEJyb3dzZXJMaXN0ICgpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdOb3QgaW1wbGVtZW50ZWQhJyk7XG4gICAgfVxuXG4gICAgYXN5bmMgaXNWYWxpZEJyb3dzZXJOYW1lICgvKiBicm93c2VyTmFtZSAqLykge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyBFeHRyYSBmdW5jdGlvbnNcbiAgICBhc3luYyBpc0xvY2FsQnJvd3NlciAoLyogYnJvd3NlcklkLCBicm93c2VyTmFtZSAqLykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgaXNIZWFkbGVzc0Jyb3dzZXIgKCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgYXN5bmMgaGFzQ3VzdG9tQWN0aW9uRm9yQnJvd3NlciAoLyogYnJvd3NlcklkICovKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBoYXNDbG9zZUJyb3dzZXI6ICAgICAgICAgICAgICAgIHRoaXMuaGFzT3duUHJvcGVydHkoJ2Nsb3NlQnJvd3NlcicpLFxuICAgICAgICAgICAgaGFzUmVzaXplV2luZG93OiAgICAgICAgICAgICAgICB0aGlzLmhhc093blByb3BlcnR5KCdyZXNpemVXaW5kb3cnKSxcbiAgICAgICAgICAgIGhhc1Rha2VTY3JlZW5zaG90OiAgICAgICAgICAgICAgdGhpcy5oYXNPd25Qcm9wZXJ0eSgndGFrZVNjcmVlbnNob3QnKSxcbiAgICAgICAgICAgIGhhc0NhblJlc2l6ZVdpbmRvd1RvRGltZW5zaW9uczogdGhpcy5oYXNPd25Qcm9wZXJ0eSgnY2FuUmVzaXplV2luZG93VG9EaW1lbnNpb25zJyksXG4gICAgICAgICAgICBoYXNNYXhpbWl6ZVdpbmRvdzogICAgICAgICAgICAgIHRoaXMuaGFzT3duUHJvcGVydHkoJ21heGltaXplV2luZG93JyksXG4gICAgICAgICAgICBoYXNDaHJvbWVsZXNzU2NyZWVuc2hvdHM6ICAgICAgIGZhbHNlXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgYXN5bmMgcmVzaXplV2luZG93IChicm93c2VySWQvKiwgd2lkdGgsIGhlaWdodCwgY3VycmVudFdpZHRoLCBjdXJyZW50SGVpZ2h0ICovKSB7XG4gICAgICAgIHRoaXMucmVwb3J0V2FybmluZyhicm93c2VySWQsIFdBUk5JTkdfTUVTU0FHRS5yZXNpemVOb3RTdXBwb3J0ZWRCeUJyb3dzZXJQcm92aWRlciwgdGhpc1tuYW1lXSk7XG4gICAgfVxuXG4gICAgYXN5bmMgY2FuUmVzaXplV2luZG93VG9EaW1lbnNpb25zICgvKiBicm93c2VySWQsIHdpZHRoLCBoZWlnaHQgKi8pIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgYXN5bmMgdGFrZVNjcmVlbnNob3QgKGJyb3dzZXJJZC8qLCBzY3JlZW5zaG90UGF0aCwgcGFnZVdpZHRoLCBwYWdlSGVpZ2h0ICovKSB7XG4gICAgICAgIHRoaXMucmVwb3J0V2FybmluZyhicm93c2VySWQsIFdBUk5JTkdfTUVTU0FHRS5zY3JlZW5zaG90Tm90U3VwcG9ydGVkQnlCcm93c2VyUHJvdmlkZXIsIHRoaXNbbmFtZV0pO1xuICAgIH1cblxuICAgIGFzeW5jIG1heGltaXplV2luZG93IChicm93c2VySWQpIHtcbiAgICAgICAgdGhpcy5yZXBvcnRXYXJuaW5nKGJyb3dzZXJJZCwgV0FSTklOR19NRVNTQUdFLm1heGltaXplTm90U3VwcG9ydGVkQnlCcm93c2VyUHJvdmlkZXIsIHRoaXNbbmFtZV0pO1xuICAgIH1cblxuICAgIGFzeW5jIHJlcG9ydEpvYlJlc3VsdCAoLypicm93c2VySWQsIHN0YXR1cywgZGF0YSovKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG59XG4iXX0=
